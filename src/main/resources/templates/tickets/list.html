<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml">
<head th:replace="fragments :: head">
    <title>Support Tickets</title>
</head>
<body class="p-8">
<h1 class="text-xl mb-4">Support Tickets</h1>

<!--/*
  p-2 = padding
  w-full = width
  mb-4 = margin bottom
  th:text = binds text
  th:value = binds value
  th:field = binds ticket properties to form fields
  th:action = form action
  th:class = add class
  th:attr = add attribute
  th:each = loop
  th:replace = replace
*/-->

<!--/*
  Action Button Comments:
  th:href = creates dynamic URL with ticket ID
  th:action = creates form action URL with ticket ID
  onsubmit = JavaScript confirmation before delete
  class="inline" = keeps delete button on same line as edit
  px-3 = horizontal padding
  py-1 = vertical padding
  mr-2 = right margin spacing
*/-->

<!-- Link to create new ticket -->
<a th:href="@{/tickets/create}" class="bg-blue-500 text-white p-2 rounded mb-4 inline-block">
    Create New Ticket
</a>

<!-- Table that takes full width with border -->
<table class="w-full border">
    <thead>
    <!-- Header row with light gray background -->
    <tr class="bg-gray-100">
        <th class="p-2">ID</th>
        <th class="p-2">Name</th>
        <th class="p-2">Email</th>
        <th class="p-2">Department</th>
        <th class="p-2">Details</th>
        <th class="p-2">Priority</th>
        <th class="p-2">Status</th>
        <th class="p-2">Date Submitted</th>
        <th class="p-2">Actions</th>
    </tr>
    </thead>
    <tbody>
    <!-- Iterate through tickets and display their properties -->
    <tr th:each="ticket : ${tickets}" class="border-t">
        <td class="p-2" th:text="${ticket.ticketId}">ID</td>
        <td class="p-2" th:text="${ticket.name}">Name</td>
        <td class="p-2" th:text="${ticket.email}">Email</td>
        <td class="p-2" th:text="${ticket.clientDepartment}">Department</td>
        <td class="p-2" th:text="${ticket.details}">Details</td>
        <td class="p-2" th:text="${ticket.priority}">Priority</td>
        <td class="p-2" th:text="${ticket.status}">Status</td>
        <td class="p-2" th:text="${ticket.getDateString(ticket.dateSubmitted)}">Date</td>
        <td class="p-2">
            <!-- Link to edit ticket -->
            <a th:href="@{/tickets/edit/{id}(id=${ticket.ticketId})}"
               class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 mr-2">
                Edit/Update Ticket
            </a>
            <!-- Form for delete ticket -->
            <form th:action="@{/tickets/delete/{id}(id=${ticket.ticketId})}"
                  method="POST"
                  class="inline"
                  onsubmit="return confirm('Are you sure you want to delete this ticket?');">
                <button type="submit"
                        class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600">
                    Delete Ticket
                </button>
            </form>
        </td>
    </tr>
    </tbody>
</table>
</body>
</html>